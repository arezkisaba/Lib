<?xml version="1.0" encoding="UTF-8"?>

<?ifndef ProductName ?>
<?define ProductName = "CHANGEME"?>
<?endif ?>

<?ifndef Version ?>
<?define Version = "1.0.0.0"?>
<?endif ?>

<?ifndef UpgradeCode ?>
<?define UpgradeCode = "00000001-0001-0001-0001-000000000001"?>
<?endif ?>

<?ifndef HandleStartup ?>
<?define HandleStartup = "False"?>
<?endif ?>

<?ifndef InstallFolder ?>
<?define InstallFolder = "C:\Program Files (x86)\Babylon"?>
<?endif ?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="$(var.ProductName)" Language="1033" Version="$(var.ProductVersion)" Manufacturer="Arezki Saba" UpgradeCode="$(var.UpgradeCode)">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <!--<MajorUpgrade Schedule="afterInstallInitialize" AllowDowngrades="no" DowngradeErrorMessage="ok" AllowSameVersionUpgrades="yes" />-->
    <MediaTemplate EmbedCab="yes" CompressionLevel="high" />
    <!--
    <WixVariable Id="WixUIBannerBmp" Value="Images\installer_top-banner.bmp" />
    <UIRef Id="WixUI_Custom" />
    -->
    <Feature Id="ProductFeature" Title="$(var.ProductName).Setup" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
    
    <CustomAction Id="Install"
                  Property="InstallProperty"
                  Value="&quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&quot; -NoLogo -NonInteractive -InputFormat None -NoProfile -File &quot;$(var.InstallFolder)\$(var.ProductName)\install.ps1&quot; -InstallFolder &quot;$(var.InstallFolder)\$(var.ProductName)&quot; -ProductName &quot;$(var.ProductName)&quot; -HandleStartup &quot;$(var.HandleStartup)&quot;"
                  Execute="immediate" />
    <CustomAction Id="InstallProperty"
									BinaryKey="WixCA"
									DllEntry="CAQuietExec64"
									Execute="deferred"
									Return="check"
									Impersonate="no" />

    <CustomAction Id="Uninstall"
                  Property="UninstallProperty"
                  Value="&quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&quot; -NoLogo -NonInteractive -InputFormat None -NoProfile -File &quot;$(var.InstallFolder)\$(var.ProductName)\uninstall.ps1&quot; -ProductName &quot;$(var.ProductName)&quot; -HandleStartup &quot;$(var.HandleStartup)&quot;"
                  Execute="immediate" />
    <CustomAction Id="UninstallProperty"
									BinaryKey="WixCA"
									DllEntry="CAQuietExec64"
									Execute="deferred"
									Return="check"
									Impersonate="no" />

    <InstallExecuteSequence>
      <Custom Action="Install" After="CostFinalize">NOT Installed</Custom>
      <Custom Action="InstallProperty" After="InstallFiles">NOT Installed</Custom>
      <Custom Action="Uninstall" Before="CostFinalize">Installed</Custom>
      <Custom Action="UninstallProperty" Before="RemoveFiles">Installed</Custom>
    </InstallExecuteSequence>
    
    <!--
    <CustomAction Id="SayHello" BinaryKey="Lib.Wix.Setup.CustomAction.CA" DllEntry="DeferredHello" Execute="deferred" Return="check" Impersonate="no" />
    <Property Id="SayHello" Value="Name=World" />
    <Binary Id="Lib.Wix.Setup.CustomAction.CA" SourceFile="..\Lib.Wix.Setup.CustomAction\bin\Debug\Lib.Wix.Setup.CustomAction.CA.dll" />
    <InstallExecuteSequence>
      <Custom Action="SayHello" After="InstallFiles" />
    </InstallExecuteSequence>
    -->
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="BabylonFolder" Name="Babylon">
          <Directory Id="ProductFolder" Name="$(var.ProductName)" />
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="ProductFolder">

      			<Component Id="AxuhewzknHbgErd" Guid="19c27404-71af-4bc9-a3e6-5b98f3704968">
				<File Id="_Artifacts_BabylonTools.XMap.deps.json" Name="BabylonTools.XMap.deps.json" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.deps.json"/>
			</Component>

			<Component Id="GbEUwOXhFrIxpJY" Guid="00b57c23-0d75-41a0-bfbe-fa08c946ad86">
				<File Id="_Artifacts_BabylonTools.XMap.dll" Name="BabylonTools.XMap.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.dll"/>
			</Component>

			<Component Id="xqKaBAIMHEjLvSJ" Guid="06066727-335b-4e5c-ac68-d9048ff271fc">
				<File Id="_Artifacts_BabylonTools.XMap.dll.config" Name="BabylonTools.XMap.dll.config" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.dll.config"/>
			</Component>

			<Component Id="pYtGPMRlmAiWcrw" Guid="6af2b022-505c-456a-8654-9f096123c8f2">
				<File Id="_Artifacts_BabylonTools.XMap.exe" Name="BabylonTools.XMap.exe" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.exe"/>
			</Component>

			<Component Id="rAwfaoEsdxecUHV" Guid="5a06d51c-7b7a-43c7-acb3-32f5be2d7665">
				<File Id="_Artifacts_BabylonTools.XMap.pdb" Name="BabylonTools.XMap.pdb" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.pdb"/>
			</Component>

			<Component Id="uOiGIomxHTfCXLh" Guid="f463617d-8a6b-4d84-a1ab-1792632f0bca">
				<File Id="_Artifacts_BabylonTools.XMap.runtimeconfig.dev.json" Name="BabylonTools.XMap.runtimeconfig.dev.json" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.runtimeconfig.dev.json"/>
			</Component>

			<Component Id="hTwirgznqWSDJvb" Guid="74a237c6-bb78-42c7-936b-37d19ae7785c">
				<File Id="_Artifacts_BabylonTools.XMap.runtimeconfig.json" Name="BabylonTools.XMap.runtimeconfig.json" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\BabylonTools.XMap.runtimeconfig.json"/>
			</Component>

			<Component Id="yzBtFxsNvkLnUwQ" Guid="44397d21-ff5f-4885-8ba5-bc2477e2aea3">
				<File Id="_Artifacts_DROP_PACKAGE_HERE.txt" Name="DROP_PACKAGE_HERE.txt" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\DROP_PACKAGE_HERE.txt"/>
			</Component>

			<Component Id="bYBhvJXqedsrnHP" Guid="79133bbf-1ed8-4058-8ee4-077279f95c3b">
				<File Id="_Artifacts_install.ps1" Name="install.ps1" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\install.ps1"/>
			</Component>

			<Component Id="cPHngXGOlyEDLoB" Guid="47ac7a7d-9bb9-4d89-8289-939d94a2abb3">
				<File Id="_Artifacts_Lib.Core.dll" Name="Lib.Core.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\Lib.Core.dll"/>
			</Component>

			<Component Id="MQohCnKOjVZpgFc" Guid="02deadff-299b-4272-b084-aa89d80967b3">
				<File Id="_Artifacts_Lib.Win32.dll" Name="Lib.Win32.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\Lib.Win32.dll"/>
			</Component>

			<Component Id="hmRMPIlKTrUHSpw" Guid="32cb695e-179e-4eef-b6f4-d11ce34c6f14">
				<File Id="_Artifacts_Microsoft.Win32.SystemEvents.dll" Name="Microsoft.Win32.SystemEvents.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\Microsoft.Win32.SystemEvents.dll"/>
			</Component>

			<Component Id="wCBWNImHQyAilpx" Guid="b88a7800-eaf5-4891-876f-52a14a190565">
				<File Id="_Artifacts_NAudio.dll" Name="NAudio.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\NAudio.dll"/>
			</Component>

			<Component Id="GadAryhzewcmoYV" Guid="97e22715-fcd2-4a5d-b0f5-37458c4f800f">
				<File Id="_Artifacts_Newtonsoft.Json.dll" Name="Newtonsoft.Json.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\Newtonsoft.Json.dll"/>
			</Component>

			<Component Id="UnbTipqLtcaHNdl" Guid="8d72f1a7-56cd-4868-9266-7583234b7712">
				<File Id="_Artifacts_README.txt" Name="README.txt" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\README.txt"/>
			</Component>

			<Component Id="UoAgmBnONaLQKiM" Guid="4754dc9e-dde6-40ea-9487-f8f7aea4c28f">
				<File Id="_Artifacts_SharpDX.dll" Name="SharpDX.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\SharpDX.dll"/>
			</Component>

			<Component Id="EBavcmxAedyuSgX" Guid="0d1832af-9cdc-4035-baea-9488a7cf04ce">
				<File Id="_Artifacts_SharpDX.XInput.dll" Name="SharpDX.XInput.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\SharpDX.XInput.dll"/>
			</Component>

			<Component Id="FQLvTdnaYXgISmP" Guid="c1d3759a-2f0f-49a7-a696-ecaa57d2944b">
				<File Id="_Artifacts_System.Configuration.ConfigurationManager.dll" Name="System.Configuration.ConfigurationManager.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Configuration.ConfigurationManager.dll"/>
			</Component>

			<Component Id="UEnJOaTWxAvZpgk" Guid="4a00b712-b81f-43ef-a5f6-b92fc02af426">
				<File Id="_Artifacts_System.Diagnostics.EventLog.dll" Name="System.Diagnostics.EventLog.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Diagnostics.EventLog.dll"/>
			</Component>

			<Component Id="SrIzOjYamGQLoEc" Guid="0fe9b38a-aa85-409d-8c29-324a18388ca1">
				<File Id="_Artifacts_System.Drawing.Common.dll" Name="System.Drawing.Common.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Drawing.Common.dll"/>
			</Component>

			<Component Id="dqGRlmfknVogsbY" Guid="6666323b-8811-480a-b9b2-b33e4678ca38">
				<File Id="_Artifacts_System.Resources.Extensions.dll" Name="System.Resources.Extensions.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Resources.Extensions.dll"/>
			</Component>

			<Component Id="vzCjQbcpWiwSVdK" Guid="2bd39cfa-601d-4735-b364-e84d3b07c0c8">
				<File Id="_Artifacts_System.Security.Cryptography.ProtectedData.dll" Name="System.Security.Cryptography.ProtectedData.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Security.Cryptography.ProtectedData.dll"/>
			</Component>

			<Component Id="IwPefHFvEhWkdax" Guid="e3f79e38-99dd-4200-8611-08606f7bf48f">
				<File Id="_Artifacts_System.Security.Permissions.dll" Name="System.Security.Permissions.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Security.Permissions.dll"/>
			</Component>

			<Component Id="LyGBehvUPfjdDSi" Guid="2d9da8ce-3c42-4abe-8ed6-4faba84d3d1a">
				<File Id="_Artifacts_System.ServiceProcess.ServiceController.dll" Name="System.ServiceProcess.ServiceController.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.ServiceProcess.ServiceController.dll"/>
			</Component>

			<Component Id="DSYPfxpRkCoKlgI" Guid="b8b3618a-beae-4475-9326-df42d1e16c2e">
				<File Id="_Artifacts_System.Windows.Extensions.dll" Name="System.Windows.Extensions.dll" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\System.Windows.Extensions.dll"/>
			</Component>

			<Component Id="ygIZJBsmfqDSQrb" Guid="ad822403-2e5a-460d-9c5f-356835aadc59">
				<File Id="_Artifacts_uninstall.ps1" Name="uninstall.ps1" Source="C:\src\git\Lib\Lib\Lib.Wix\Lib.Wix.Setup\Artifacts\uninstall.ps1"/>
			</Component>


    </ComponentGroup>
  </Fragment>
</Wix>
